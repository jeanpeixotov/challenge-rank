"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const app_1 = require("../../models/app");
async function list() {
    return await app_1.App.query();
}
exports.list = list;
async function insert(model, transaction = null) {
    for (let m of model) {
        const app = await findByBundleId(m.bundleId);
        app ? await update(m) : await app_1.App.query(transaction).insert(m);
    }
}
exports.insert = insert;
async function findByBundleId(id) {
    return await app_1.App.query().where('bundleId', id).first();
}
exports.findByBundleId = findByBundleId;
async function update(data) {
    await app_1.App.query().update(data).where({ bundleId: data.bundleId });
}
exports.update = update;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc2VydmVyL21vZHVsZXMvcmVwb3NpdG9yaWVzL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDBDQUF1QztBQUloQyxLQUFLO0lBQ1YsTUFBTSxDQUFDLE1BQU0sU0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQzNCLENBQUM7QUFGRCxvQkFFQztBQUVNLEtBQUssaUJBQWlCLEtBQWEsRUFBRSxjQUEyQixJQUFJO0lBQ3pFLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDcEIsTUFBTSxHQUFHLEdBQUcsTUFBTSxjQUFjLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzdDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sU0FBRyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakUsQ0FBQztBQUNILENBQUM7QUFMRCx3QkFLQztBQUVNLEtBQUsseUJBQXlCLEVBQVU7SUFDN0MsTUFBTSxDQUFDLE1BQU0sU0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDekQsQ0FBQztBQUZELHdDQUVDO0FBRU0sS0FBSyxpQkFBaUIsSUFBVTtJQUNyQyxNQUFNLFNBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO0FBQ3BFLENBQUM7QUFGRCx3QkFFQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcCB9IGZyb20gJy4uLy4uL21vZGVscy9hcHAnO1xuaW1wb3J0IHsgSUFwcCB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvYXBwJztcbmltcG9ydCB7IFRyYW5zYWN0aW9uIH0gZnJvbSAnb2JqZWN0aW9uJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3QoKTogUHJvbWlzZTxBcHBbXT4ge1xuICByZXR1cm4gYXdhaXQgQXBwLnF1ZXJ5KCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnQobW9kZWw6IElBcHBbXSwgdHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uID0gbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuICBmb3IgKGxldCBtIG9mIG1vZGVsKSB7XG4gICAgY29uc3QgYXBwID0gYXdhaXQgZmluZEJ5QnVuZGxlSWQobS5idW5kbGVJZCk7XG4gICAgYXBwID8gYXdhaXQgdXBkYXRlKG0pIDogYXdhaXQgQXBwLnF1ZXJ5KHRyYW5zYWN0aW9uKS5pbnNlcnQobSk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRCeUJ1bmRsZUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPEFwcD4ge1xuICByZXR1cm4gYXdhaXQgQXBwLnF1ZXJ5KCkud2hlcmUoJ2J1bmRsZUlkJywgaWQpLmZpcnN0KCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGUoZGF0YTogSUFwcCk6IFByb21pc2U8dm9pZD4ge1xuICBhd2FpdCBBcHAucXVlcnkoKS51cGRhdGUoZGF0YSkud2hlcmUoeyBidW5kbGVJZDogZGF0YS5idW5kbGVJZCB9KTtcbn0iXX0=