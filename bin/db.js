"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const knex = require("knex");
const objection = require("objection");
const settings = require("./settings");
// tslint:disable-next-line
const knexConfig = require('../knexfile');
function connect(config = null) {
    const connection = knex(config || knexConfig[settings.env]);
    objection.Model.knex(connection);
    return connection;
}
exports.connect = connect;
async function connectAndMigrate() {
    const connection = connect();
    await connection.migrate.latest();
    await connection.seed.run();
    return connection;
}
exports.connectAndMigrate = connectAndMigrate;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zZXJ2ZXIvZGIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2QkFBNkI7QUFDN0IsdUNBQXVDO0FBQ3ZDLHVDQUF1QztBQUV2QywyQkFBMkI7QUFDM0IsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBRTFDLGlCQUF3QixTQUFzQixJQUFJO0lBQ2hELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLElBQUksVUFBVSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQzVELFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBRWpDLE1BQU0sQ0FBQyxVQUFVLENBQUM7QUFDcEIsQ0FBQztBQUxELDBCQUtDO0FBRU0sS0FBSztJQUNWLE1BQU0sVUFBVSxHQUFHLE9BQU8sRUFBRSxDQUFDO0lBRTdCLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNsQyxNQUFNLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFFNUIsTUFBTSxDQUFDLFVBQVUsQ0FBQztBQUNwQixDQUFDO0FBUEQsOENBT0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBrbmV4IGZyb20gJ2tuZXgnO1xuaW1wb3J0ICogYXMgb2JqZWN0aW9uIGZyb20gJ29iamVjdGlvbic7XG5pbXBvcnQgKiBhcyBzZXR0aW5ncyBmcm9tICcuL3NldHRpbmdzJztcblxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXG5jb25zdCBrbmV4Q29uZmlnID0gcmVxdWlyZSgnLi4va25leGZpbGUnKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbm5lY3QoY29uZmlnOiBrbmV4LkNvbmZpZyA9IG51bGwpOiBrbmV4IHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGtuZXgoY29uZmlnIHx8IGtuZXhDb25maWdbc2V0dGluZ3MuZW52XSk7XG4gIG9iamVjdGlvbi5Nb2RlbC5rbmV4KGNvbm5lY3Rpb24pO1xuXG4gIHJldHVybiBjb25uZWN0aW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29ubmVjdEFuZE1pZ3JhdGUoKTogUHJvbWlzZTxrbmV4PiB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBjb25uZWN0KCk7XG5cbiAgYXdhaXQgY29ubmVjdGlvbi5taWdyYXRlLmxhdGVzdCgpO1xuICBhd2FpdCBjb25uZWN0aW9uLnNlZWQucnVuKCk7XG5cbiAgcmV0dXJuIGNvbm5lY3Rpb247XG59Il19